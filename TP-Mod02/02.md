# TP 2 : Création et exécution d’un pipeline déclaratif

## Objectifs
- Comprendre la structure d’un pipeline déclaratif Jenkins.
- Exécuter un pipeline en définissant le script directement dans le formulaire du job.
- Déplacer le pipeline dans un Jenkinsfile stocké sur GitHub et le référencer dans Jenkins.

## Prérequis
- Accès à Jenkins fourni par le formateur.
- Un projet GitHub pour stocker le Jenkinsfile.

# Étape 1 : Création d’un pipeline via le formulaire Jenkins

## 1. Connexion à Jenkins
- Ouvrir Jenkins via l’URL fournie par le formateur.
- Se connecter avec vos identifiants.

## 2. Création d’un nouveau pipeline
- Aller dans "New Item" → "Pipeline".
- Donner un nom au job et cliquer sur OK.

## 3. Définition du pipeline dans le formulaire
- Aller dans l’onglet "Pipeline".
- Sélectionner "Pipeline script".
- Coller le code suivant :

```groovy
pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                echo 'Building...'
            }
        }
        stage('Test') {
            steps {
                echo 'Testing...'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying...'
            }
        }
    }
}
``` 
## 4. Exécution du pipeline
- Sauvegarder et exécuter le job.

- Observer les logs d’exécution.

# Étape 2 : Utilisation d’un Jenkinsfile stocké sur GitHub
## 1. Créer un dépôt GitHub
- Aller sur GitHub et créer un nouveau repo.

- Cloner le repo localement :

```bash
git clone https://github.com/votre-utilisateur/jenkins-pipeline.git
cd jenkins-pipeline
```
## 2. Créer un Jenkinsfile et y insérer le pipeline
- Créer un fichier Jenkinsfile et y copier :

```groovy
pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                echo 'Building...'
            }
        }
        stage('Test') {
            steps {
                echo 'Testing...'
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploying...'
            }
        }
    }
}
``` 
- Ajouter, committer et pousser :

```bash
git add Jenkinsfile
git commit -m "Ajout du Jenkinsfile"
git push origin main
```
## 3. Configurer Jenkins pour utiliser le Jenkinsfile
- Aller dans Jenkins → Modifier le job.

- Dans l’onglet Pipeline, sélectionner Pipeline script from SCM.

- Dans SCM, choisir Git et renseigner l’URL du repo GitHub.

- Sauvegarder et exécuter le job.