# TP Chapitre 6 ‚Äì Administration Jenkins üõ°Ô∏è

## Contexte / Storytelling
La startup GFP Tech g√®re maintenant plusieurs pipelines et agents Jenkins.  
Pour garantir la **s√©curit√©, la fiabilit√© et la performance** du syst√®me, il est essentiel de mettre en place des pratiques d‚Äôadministration : gestion des utilisateurs, monitoring, sauvegardes et plans de reprise d‚Äôactivit√©.

---

## Objectifs p√©dagogiques
- Configurer la **s√©curit√© Jenkins** et g√©rer les utilisateurs et r√¥les.  
- Mettre en place le **monitoring** des ressources (CPU, RAM, disque).  
- Configurer la **sauvegarde automatique** du `$JENKINS_HOME`.  
- Tester un **plan de reprise** en cas d‚Äôincident.

---

## Pr√©requis techniques
- Jenkins install√© et fonctionnel avec pipelines existants (Chapitre 1 √† 5).  
- Acc√®s administrateur Jenkins.  
- Acc√®s SSH ou console pour la gestion des agents et sauvegardes.  

---

## √âtapes d√©taill√©es

### **1. Activer la s√©curit√© Jenkins**
1. Aller dans **Manage Jenkins ‚Üí Configure Global Security**.  
2. Activer :  
   - Jenkins own user database  
   - Matrix-based security (RBAC)  
3. Cr√©er des utilisateurs avec diff√©rents r√¥les :  
   - Admin : acc√®s complet  
   - Developer : acc√®s pipelines  
   - Viewer : lecture seule  

### **2. Configurer les permissions et r√¥les**
1. D√©finir les permissions par type d‚Äôutilisateur (ex: `Job ‚Üí Build` pour Developer, `Administer` pour Admin).  
2. V√©rifier que les utilisateurs ne peuvent acc√©der qu‚Äôaux pipelines autoris√©s.

### **3. Monitoring et points de stress**
1. Installer plugin **Monitoring** ou **Metrics**.  
2. Suivre CPU, RAM et espace disque Jenkins.  
3. Simuler un build lourd pour observer la charge.  
4. Ajouter alertes ou notifications si seuils d√©pass√©s.

### **4. Sauvegarde automatique**
1. Cr√©er un script `backup_jenkins.sh` :

```bash
#!/bin/bash
tar -czf /backups/jenkins_home_$(date +%F_%H-%M).tar.gz $JENKINS_HOME
```
2. Ajouter un **cron job** sur le serveur Jenkins :

```bash
0 2 * * * /path/to/backup_jenkins.sh
```

### **5. Plan de reprise / rollback**
1. Arr√™ter Jenkins.  
2. Restaurer le backup le plus r√©cent :  
   ```bash
   tar -xzf /backups/jenkins_home_latest.tar.gz -C $JENKINS_HOME
   systemctl restart jenkins
   ```  
3. V√©rifier que les pipelines et agents sont fonctionnels.

### **6. Int√©gration avec le projet fil rouge**
1. V√©rifier que le pipeline multibranch fonctionne m√™me apr√®s restauration.  
2. Simuler un incident : supprimer un build ou un agent et restaurer.  
3. Observer les logs et notifications.

---

## Livrable final
- Jenkins s√©curis√© avec utilisateurs et r√¥les configur√©s.  
- Monitoring actif et seuils configur√©s.  
- Sauvegarde automatique du `$JENKINS_HOME`.  
- Plan de reprise test√© avec pipeline multibranch op√©rationnel.

---

## Bonus (optionnel)
- Mettre en place des **snapshots r√©guliers des agents** pour acc√©l√©rer la r√©cup√©ration.  
- Ajouter des **dashboards personnalis√©s** pour le suivi des ressources et builds.  
- D√©ployer un **agent temporaire** pour tester la mont√©e en charge.
~~~

