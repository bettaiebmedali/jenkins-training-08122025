# TP Chapitre 7 â€“ Agents Jenkins ğŸ¤–

## Contexte / Storytelling
La startup GFP Tech voit son nombre de pipelines augmenter et ses builds devenir plus lourds.  
Pour gÃ©rer la charge et **optimiser les temps de build**, il est nÃ©cessaire dâ€™installer et configurer des **agents Jenkins distants**.  
Ces agents permettent dâ€™isoler les builds, rÃ©partir la charge et garantir la stabilitÃ© de Jenkins.

---

## Objectifs pÃ©dagogiques
- Installer et configurer un agent Jenkins distant.  
- ExÃ©cuter des pipelines sur des agents spÃ©cifiques.  
- Comprendre la rÃ©partition des ressources et la scalabilitÃ©.  
- Tester la communication et sÃ©curitÃ© entre master et agent.

---

## PrÃ©requis techniques
- Jenkins Master fonctionnel avec pipelines Chapitre 1 Ã  6.  
- AccÃ¨s SSH Ã  une machine distante (VM ou container).  
- Java et Docker installÃ©s sur lâ€™agent (si besoin).  
- Droits administrateur Jenkins pour configurer les agents.

---

## Ã‰tapes dÃ©taillÃ©es

### **1. PrÃ©parer la machine agent**
1. Installer Java sur lâ€™agent :  
   ```bash
   sudo apt update && sudo apt install openjdk-17-jdk -y
   ```
2. CrÃ©er un utilisateur dÃ©diÃ© `jenkins` sur lâ€™agent :  
   ```bash
   sudo adduser jenkins
   ```
3. Configurer les clÃ©s SSH pour lâ€™accÃ¨s Jenkins Master â†’ Agent.

### **2. Ajouter lâ€™agent dans Jenkins**
1. Aller dans **Manage Jenkins â†’ Manage Nodes and Clouds â†’ New Node**.  
2. Configurer :  
   - Nom : `agent1`  
   - Type : Permanent Agent  
   - Remote root directory : `/home/jenkins`  
   - Launch method : **Launch agents via SSH**  
   - Credentials : utilisateur `jenkins` avec clÃ© SSH

### **3. Configurer lâ€™exÃ©cution de pipelines sur lâ€™agent**
1. Dans un `Jenkinsfile`, spÃ©cifier lâ€™agent :  
   ```groovy
   pipeline {
       agent { label 'agent1' }
       stages {
           stage('Build') {
               steps {
                   sh 'mvn clean compile'
               }
           }
       }
   }
   ```
2. DÃ©clencher le pipeline et vÃ©rifier quâ€™il sâ€™exÃ©cute sur lâ€™agent distant.  

### **4. Tester la scalabilitÃ© et isolation**
1. CrÃ©er plusieurs jobs ou multibranch pipelines.  
2. Observer la rÃ©partition sur lâ€™agent : parallÃ©lisation et consommation de ressources.  
3. Installer un deuxiÃ¨me agent et configurer des labels pour rÃ©partir certains jobs.

### **5. IntÃ©gration avec le projet fil rouge**
1. Sâ€™assurer que tous les pipelines existants (build, tests, dÃ©ploiement) peuvent sâ€™exÃ©cuter sur les agents.  
2. VÃ©rifier les logs et les artefacts pour chaque exÃ©cution.

---

## Livrable final
- Un ou plusieurs agents Jenkins configurÃ©s et connectÃ©s au Master.  
- Pipelines exÃ©cutÃ©s avec succÃ¨s sur les agents distants.  
- RÃ©partition des builds efficace et isolation des environnements.

---

## Bonus (optionnel)
- Configurer des agents **Docker** pour exÃ©cuter des builds dans des containers Ã©phÃ©mÃ¨res.  
- Ajouter un agent temporaire pour tests de charge.  
- Surveiller les agents via plugin **Monitoring** pour dÃ©tecter surcharge ou erreurs.
~~~

